; Código principal
LDV 1                      ; Cargar la hilera
BST 0 0                    ; Almacenar la hilera en la posición 0
LDF $1                     ; Cargar la función que calcula el largo
BST 0 1                    ; Almacenar la dirección de la hilera en la posición 1

LDV 0                      ; Inicializar longitud en 0
BST 0 2                    ; Almacenar longitud en la posición 2

; Comienza el bucle
BLD 0 1                    ; Cargar la hilera
LNT                        ; Verificar si la hilera está vacía
BT +8                      ; Si está vacía, saltar a la salida

; Incrementar longitud
BLD 0 2                    ; Cargar longitud
LDV 1                      ; Cargar 1
ADD                        ; longitud++
BST 0 2                    ; Guardar longitud actualizada

; Continuar al siguiente carácter
BLD 0 1                    ; Cargar la hilera
LDV 1                      ; Cargar la posición actual
LRK                        ; Obtener el k-ésimo carácter (k = posición)
BST 0 1                    ; Actualizar la hilera en la posición 1

BR -6                      ; Repetir el bucle

; Fin del bucle, devolver longitud
BLD 0 2                    ; Cargar longitud final
RET                        ; Retornar longitud

; Funciones al final
$FUN $1                    ; Declaración de la función para calcular el largo
LDF $2                     ; Cargar la función que obtiene el largo
RET                        ; Retornar
$END $1                    ; Fin de la función

$FUN $2                    ; Función que cuenta el largo de la lista
BLD 1 0                    ; Cargar la lista
LNT                        ; Comprobar si está vacía
BT +8                      ; Saltar si está vacía

LDV 1                      ; Inicializar en 0
BST 2 0                    ; Almacenar longitud en posición 0

; Comienza el bucle
BLD 1 0                    ; Cargar lista
LDV 1                      ; Cargar longitud
ADD                        ; Incrementar longitud
BST 2 0                    ; Almacenar longitud

; Continuar al siguiente elemento
BLD 1 0                    ; Cargar lista
LDV 1                      ; Cargar longitud
LRK                        ; Obtener el k-ésimo elemento
BST 1 0                    ; Almacenar lista en posición 0

BR -6                      ; Repetir el bucle

; Fin del bucle
BLD 2 0                    ; Cargar longitud final
RET                        ; Retornar longitud
$END $2                    ; Fin de la función
HLT                        ; Terminar la ejecución
